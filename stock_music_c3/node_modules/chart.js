'use strict';

var c3 = require('c3');

var margin = {top: 100, right: 100, bottom: 50, left: 100},
	width = window.innerWidth,
	height = window.innerHeight;

var Chart = function (stock, region_object) {
	var date_points = [];
	var indices = [];

	return c3.generate({
		bindto: '#chart',
		
		data: {
			x: 'x',
			columns: [ stock.dates, stock.deltas ],
			onclick: function(d, element){
				date_points.push(d.x);
				console.log(d.index);
				indices.push(d.index);

				if(date_points.length % 2 == 0){
					this.regions()[0].start = 	date_points[date_points.length - 2];
					this.regions()[0].end = 	date_points[date_points.length - 1];

					this.start_index =	Math.min(indices[indices.length - 2],indices[indices.length - 1]);
					this.end_index 	 =	Math.max(indices[indices.length - 2],indices[indices.length - 1]);
					console.log(this.start_index);
				} 
			}
		},

		axis: {
			x: {
				type: 'timeseries',
				tick: {
					format: '%Y-%m-%d',
					fit: true
				}
			}
		},

		size: {
			width: width,
			height: height
		},

		padding: {
			top: margin.top,
			bottom: margin.bottom,
			left: margin.left,
			right: margin.right
		},

		regions: region_object,

		tooltip: {
			show: false
		},

		// zoom: {
		// 	enabled: true
		// }

		// subchart: {
		// 	show: true
		// },

		// selection: {
		// 	enabled: true
		// }
	})
}

module.exports = Chart;