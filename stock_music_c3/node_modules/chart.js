'use strict';

var c3 = require('c3');

var margin = {top: 100, right: 100, bottom: 50, left: 100},
	width = window.innerWidth,
	height = window.innerHeight;

var Chart = function (stock, region_object) {
	var date_points = [];
	var indices = [];

	return c3.generate({
		bindto: '#chart',
		
		data: {
			x: 'x',
			columns: [ stock.dates, stock.deltas ],
			// onclick: function(d, element){
			// 	date_points.push(d.x);
			// 	console.log(d.index);
			// 	indices.push(d.index);

			// 	if(date_points.length % 2 == 0){
			// 		this.regions()[0].start = 	date_points[date_points.length - 2];
			// 		this.regions()[0].end = 	date_points[date_points.length - 1];

			// 		this.start_index =	Math.min(indices[indices.length - 2],indices[indices.length - 1]);
			// 		this.end_index 	 =	Math.max(indices[indices.length - 2],indices[indices.length - 1]);
			// 		console.log(this.start_index);
			// 	} 
			// }
		},

		axis: {
			x: {
				type: 'timeseries',
				tick: {
					format: '%Y-%m-%d',
					fit: true
				}
			}
		},

		size: {
			width: width,
			height: height
		},

		padding: {
			top: margin.top,
			bottom: margin.bottom,
			left: margin.left,
			right: margin.right
		},

		// regions: region_object,

		tooltip: {
			show: false
		},

		zoom: {
			enabled: true,
			onzoom: function(d){
				for (var i in stock.dates) {
					if(typeof(stock.dates[i])==="object"){
						if(	stock.dates[i].getDate() === d[0].getDate() &&
							stock.dates[i].getMonth() === d[0].getMonth() && 
							stock.dates[i].getYear() === d[0].getYear() ) this.start_index = i;
						if(	stock.dates[i].getDate() === d[1].getDate() &&
							stock.dates[i].getMonth() === d[1].getMonth() && 
							stock.dates[i].getYear() === d[1].getYear() ) this.end_index = i;							
					}
				}
				// console.log(Number(d[0]));
				// console.log(Number(stock.dates[1]));

				// if(d[0].getDay() === stock.dates[] == Number(stock.dates[1])) console.log(stock.dates[1]);
				// this.start_index = d[0];
			}
		},

		subchart: {
			show: true
		},

		selection: {
			enabled: false
		}
	})
}

module.exports = Chart;